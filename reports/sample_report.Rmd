---
title: "My PDF Report with R Markdown"
author:
- My Name
output: pdf_document
fontsize: 12pt
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r}
library("tximport")
library("readr")
library("tximportData")
dir <- system.file("extdata", package="tximportData")
```

## File Inputs

### Salmon Quantification Inputs

```{r, echo=FALSE, message=FALSE}
samples2 <- read.table(file.path("/", "samples.txt"), head=TRUE)
files <- file.path("/", samples2$Sample, "quant.sf")
files
```


### Differential expression analysis
```{r, echo=FALSE, message=FALSE}
library("DESeq2")

tx2gene <- read_csv(file.path(dir, "tx2gene.gencode.v27.csv"))
txi <- tximport(files, type="salmon", tx2gene=tx2gene)

dds <- DESeqDataSetFromTximport(txi, colData = samples2, design = ~ Condition)
dds <- DESeq(dds)
res <- results(dds)

summary(res)
```